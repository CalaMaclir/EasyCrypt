# EasyCrypt & EasyKeyManager

`EasyCrypt.ps1` および `EasyKeyManager.ps1` は、**ファイルの暗号化・復号処理および鍵管理** を **GUI(フォーム)** 上で簡単に行える PowerShell スクリプトです。

## EasyCrypt.ps1

`EasyCrypt.ps1` は、**複数の公開鍵でファイルを暗号化し、復号時に適切な秘密鍵を自動選択して復号を行う** ことができるスクリプトです。

- **暗号化 (Encrypt)** : 指定した公開鍵を使ってファイルを暗号化
- **復号 (Decrypt)** : 暗号ファイルに埋め込まれた Modulus を参照し、 所持している秘密鍵を自動判定して復号
- **ドラッグ＆ドロップ対応** : GUI 上でファイルを簡単に暗号化・復号
- **RSA 4096bit + AES 256bit による高セキュリティ暗号化**

## EasyKeyManager.ps1

`EasyKeyManager.ps1` は、**ユーザーストア(秘密鍵) + `keys` フォルダ(公開鍵) を管理** するスクリプトです。

- **鍵ペアの生成 (Generate Key)** : ユーザーストアに秘密鍵を保存し、公開鍵を `keys` フォルダに作成
- **秘密鍵のエクスポート (Export Key)** : ユーザーストアから秘密鍵を `keys/secret` に保存
- **秘密鍵のインポート (Import Key)** : `.pvtkey` 形式の秘密鍵をインポートし、対応する公開鍵を自動作成

## 特徴

1. **誰でも簡単に使えるものを目指して**  
   誰でも簡単に使えるものを目指しました。  

2. **複数の公開鍵による暗号化に対応**  
   一般的には公開鍵ごとに暗号化作業が必要でしたが、公開鍵が複数であっても1ファイルで対応します。

3. **鍵管理がシンプル**  
   - `keys` ディレクトリにある `.pubkey`（公開鍵）は GUI のリストから選択可能。
   - `keys` ディレクトリは作業ディレクトリの下に作成され使用されますので、本スクリプトのショートカットを作成して、作業ディレクトリを定義しておけば、1本のプログラムで異なる環境を作成することも可能です。
   - `.pvtkey`（秘密鍵）は画面上には表示せず、`keys`内の秘密鍵をサーチして Modulus で一致するものを自動的に使用します。
   - `keys` ディレクトリの鍵名は拡張子を変更しなければ、自由に変更していただいて構いません。
      > **Note**:  
      > `keys` ディレクトリが存在しない場合は、スクリプトを初回起動時に自動生成します。

## ダウンロード

以下のリンクからスクリプトをダウンロードしてください。

- [EasyCrypt.ps1](./EasyCrypt.ps1)
- [EasyKeyManager.ps1](./EasyKeyManager.ps1)

## 必要環境

- Windows PowerShell 5.x もしくは PowerShell 7.x  
- Windows デスクトップ上で .NET Framework / .NET Runtime が利用可能な環境  
- GUI を表示可能な環境

## 使い方

1. **スクリプトの起動**

   `EasyCrypt.ps1` または `EasyKeyManager.ps1` を右クリックして「PowerShell で実行」などで起動します。

2. **鍵ペアの生成 (Generate Key)**

   - `EasyKeyManager.ps1` の「Generate Key」ボタンを押すと、RSA 4096bit 鍵ペアを作成します。作成時に名称を聞いてきますので、任意の名称をつけてください。

3. **暗号化 (Encrypt)**

   - `EasyCrypt.ps1` の「Encrypt (暗号化)」ボタンを押すと、指定した公開鍵でファイルを暗号化します。公開鍵は複数指定可能です。

4. **復号 (Decrypt)**

   - `.enc` ファイルをリストに追加し、「Decrypt (復号)」ボタンを押すと、適切な秘密鍵を判定し、復号します。

5. **鍵管理**

   - `EasyKeyManager.ps1` を使用して、ユーザーストアに対し、秘密鍵のエクスポート・インポートが可能です。
   - 秘密鍵をインポートするとき、対応する公開鍵を `keys` フォルダに作成します。

## 注意点

- **秘密鍵 (.pvtkey) の保管**  
  - エクスポートした秘密鍵を第三者に漏洩すると暗号ファイルを解読される恐れがあります。  
  - 取り扱いには十分ご注意ください。

- **公開鍵 (.pubkey) の保管**  
  - 公開鍵と秘密鍵はそれぞれ対応していますので、公開鍵をリネームしたり削除すると秘密鍵にアクセスできなくなるので注意してください
   
- **キーサイズやアルゴリズム**  
  - デフォルトで RSA 4096bit + AES 256bit (CBCモード) を使用しています。  

- **実装等について**  
  - 次のリポジトリも参照してください  
    [GitHub - EncryptDecryptWithPublickey](https://github.com/CalaMaclir/EncryptDecryptWithPublickey)

## ライセンス

- 制作者がCala Maclirであることを明記いただけることを守っていただければ、ご自由に流用いただいて構いません。
- ただし、利益を伴う利用については協議させてください。
